## Labs

| #     | Lab Name                                                                                                                  | Level        | Type    |
| ----- | ------------------------------------------------------------------------------------------------------------------------- | ------------ | ------- |
| 22 ✅ | [Exploiting cross-site scripting to steal cookies](Exploiting%20cross-site%20scripting%20to%20steal%20cookies.md)         | PRACTITIONER | Exploit |
| 23 ✅ | [Exploiting cross-site scripting to capture passwords](Exploiting%20cross-site%20scripting%20to%20capture%20passwords.md) | PRACTITIONER | Exploit |
| 24    | [Exploiting XSS to perform CSRF](Exploiting%20XSS%20to%20perform%20CSRF.md)                                               | PRACTITIONER | Exploit |

## XSS to steal cookies
- Traditional web applications often use cookies to manage user sessions.
- Attackers may attempt to steal session cookies through cross-site scripting (XSS) attacks in order to gain unauthorized access to a victim's account.
- However, there are limitations to this attack vector:
    - **Login Status:** The victim must be logged into the targeted web application for their session cookie to be available for theft.
    - **HttpOnly Flag:** Session cookies can be set with the **`HttpOnly`** flag, which restricts access by JavaScript. This prevents direct access to the cookie through XSS attacks, making cookie theft more difficult.
    - **Session Timeout:** Web application sessions have a timeout period, which means that a session cookie can become invalid if the user's session expires due to inactivity or a predefined timeout duration. Exploiting XSS to steal session cookies relies on the session being active and the cookie being valid.

### What is `HttpOnly` flag used for ?
- The **`HttpOnly`** flag is a security attribute for HTTP cookies.
- It prevents client-side JavaScript code from accessing the cookie.
- The primary purpose is to mitigate **cross-site scripting (XSS)** attacks.
- By restricting cookie access, it helps protect against theft of session cookies through XSS attacks.
- The browser enforces strict rules to ensure the cookie is only accessible through HTTP requests.
- JavaScript running on the page cannot read or modify the cookie's value.
- Provides an additional layer of protection for sensitive information stored in cookies.
- It is a server-side configuration set by the web application.
- Web developers decide which cookies should have the HttpOnly flag based on data sensitivity.

## XSS to capture passwords
- Password managers are commonly used by users to auto-fill their passwords.
- Exploiting this behavior, an attacker can create a password input field and extract the auto-filled password.
- The extracted password can then be sent to the attacker's domain.
- This technique circumvents the challenges associated with stealing cookies and can potentially provide access to other accounts where the victim has reused the same password.
- One limitation of this technique is that it relies on users having a password manager with password auto-fill functionality.
- If a user doesn't have a saved password, the attacker can still attempt to obtain their password through on-site phishing attacks, although the success rate may vary.
- It's important to note that this technique primarily relies on the availability and usage of password managers for auto-fill functionality.

## XSS to perform CSRF
- Cross-Site Scripting (XSS) allows attackers to perform various actions on a targeted website, similar to what legitimate users can do.
- With XSS, an attacker can manipulate a victim into sending messages, accepting friend requests, committing backdoors to source code repositories, or even transferring cryptocurrency like Bitcoin.
- Exploiting an XSS vulnerability, an attacker can trigger certain functionalities on a website, such as changing the victim's email address without requiring their password.
- By changing the victim's email address to one controlled by the attacker, they can then initiate a password reset process and gain unauthorized access to the victim's account.
- This type of exploit is often referred to as Cross-Site Request Forgery (CSRF), which can be confusing as CSRF can also exist as an independent vulnerability.
- Standalone CSRF vulnerabilities can be mitigated with measures like anti-CSRF tokens, but these measures do not protect against XSS vulnerabilities that can enable CSRF attacks.